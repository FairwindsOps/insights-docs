(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{260:function(t,e,s){"use strict";s.r(e);var a=s(28),n=Object(a.a)({},(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("h1",{attrs:{id:"continuous-integration"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#continuous-integration"}},[t._v("#")]),t._v(" Continuous Integration")]),t._v(" "),s("blockquote",[s("p",[t._v("This is an "),s("strong",[t._v("experimental feature")]),t._v(".")]),t._v(" "),s("p",[t._v("To enable the Contiuous Integration beta, open\nyour browser console on insights.fairwinds.com and type")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("localStorage.setItem('ci_beta', 'true');\n")])])]),s("p",[t._v("Then hit enter and refresh the page. You should see a new tab, "),s("code",[t._v("Repositories")]),t._v(", on your organization\npage.")])]),t._v(" "),s("p",[t._v("Fairwinds Insights can do more than just scan and audit a live Kubernetes Cluster. It can also\nhelp you spot issues "),s("em",[t._v("before")]),t._v(" they make it into production.")]),t._v(" "),s("p",[t._v("By adding Fairwinds Insights into your Continuous Integration process, you can catch image\nvulnerabilities and Kubernetes misconfigurations early in the development process. Insights\ncan scan changes the changes in each pull request, notifying developers or breaking the build\nwhenever security, efficiency, or reliability issues are found.")]),t._v(" "),s("h1",{attrs:{id:"setup"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[t._v("#")]),t._v(" Setup")]),t._v(" "),s("p",[t._v("To get started, visit your organization's "),s("strong",[t._v("Repositories")]),t._v(" tab, and click "),s("strong",[t._v("Add Repo")])]),t._v(" "),s("img",{attrs:{src:t.$withBase("/img/add-repo.png"),alt:"action items"}}),t._v(" "),s("p",[t._v("Following the instructions there, add a "),s("code",[t._v("fairwinds-insights.yaml")]),t._v(" configuration to the base\nof your repository. Here's a minimal example:")]),t._v(" "),s("blockquote",[s("p",[t._v("Be sure to replace "),s("code",[t._v("acme-co")]),t._v(" with your organization's name in Insights.")])]),t._v(" "),s("div",{staticClass:"language-yaml extra-class"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("options")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("setExitCode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[t._v("true")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("organization")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" acme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("co\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("images")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("docker")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" nginx"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("1.18"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("alpine\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" quay.io/acme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("co/my"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v("app"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("$CI_HASH\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("manifests")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("yaml")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./deploy/mainfests/\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" ./main.deployment.yaml\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("helm")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" prod\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("path")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" ./deploy/chart\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("values")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[t._v("foo")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" bar\n")])])]),s("p",[t._v("Next, you'll need to add the "),s("code",[t._v("FAIRWINDS_TOKEN")]),t._v(" environment variable to your CI environment. This\ntoken can be found in the CI instructions in Insights, or on your organization's settings page. Note that\nmost CI platforms provide a way to specify secrets in your environment variables.")]),t._v(" "),s("p",[t._v("Last, you'll need to execute the Insights CI script within your CI pipeline.\nYou may want to download, inspect, and store a copy of the script in your repository.")]),t._v(" "),s("div",{staticClass:"language- extra-class"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[t._v("curl https://insights.fairwinds.com/static/insights-ci.sh | bash\n")])])]),s("p",[t._v("Your repository will show up in the Insights UI once that script has been successfully run.")]),t._v(" "),s("h2",{attrs:{id:"fairwinds-insights-yaml"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#fairwinds-insights-yaml"}},[t._v("#")]),t._v(" fairwinds-insights.yaml")]),t._v(" "),s("p",[t._v("Here's a full list of options available in fairwinds-insights.yaml:")]),t._v(" "),s("h3",{attrs:{id:"options"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#options"}},[t._v("#")]),t._v(" Options")]),t._v(" "),s("p",[t._v("These are high-level options for the Insights CI integration.")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("options.organization")]),t._v(" - the name of your organization in Insights")]),t._v(" "),s("li",[s("code",[t._v("options.setExitCode")]),t._v(" - set a non-zero exit code if issues are found. Default "),s("code",[t._v("false")])]),t._v(" "),s("li",[s("code",[t._v("options.baseBranch")]),t._v(" - the branch to compare results to. Default "),s("code",[t._v("master")])]),t._v(" "),s("li",[s("code",[t._v("options.newActionItemThreshold")]),t._v(" - the maximum number of new action items that can appear for a passing test. Default "),s("code",[t._v("0")])]),t._v(" "),s("li",[s("code",[t._v("options.severityThreshold")]),t._v(" - if "),s("em",[t._v("any")]),t._v(" action item hits this threshold, the test will fail. Default "),s("code",[t._v("danger")])]),t._v(" "),s("li",[s("code",[t._v("options.junitOutput")]),t._v(" - if specified, Insights will print JUnit XML results here")]),t._v(" "),s("li",[s("code",[t._v("options.repositoryName")]),t._v(" - the name of the repository. Must match the name in GitHub if using the GitHub integration. Defaults to the output of "),s("code",[t._v("git remote -v")])]),t._v(" "),s("li",[s("code",[t._v("options.tempFolder")]),t._v(" - a temporary directory to store files in. Default "),s("code",[t._v("./_insightsTemp/")])]),t._v(" "),s("li",[s("code",[t._v("options.hostname")]),t._v(" - the host of the Insights instance to send results to. Default "),s("code",[t._v("https://insights.fairwinds.com")])])]),t._v(" "),s("h3",{attrs:{id:"images"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#images"}},[t._v("#")]),t._v(" Images")]),t._v(" "),s("p",[t._v("Specify any images you'd like Insights to scan for vulnerabilities. These images must be available\nlocally in your CI environment, either through running "),s("code",[t._v("docker build")]),t._v(" or "),s("code",[t._v("docker pull")]),t._v(".")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("images.docker")]),t._v(" - an array of image names and tags to scan")]),t._v(" "),s("li",[s("code",[t._v("images.folder")]),t._v(" - path to a folder containing exported docker images as .tgz files. Helpful if your images are in an alternative daemon like podman or cri-o (if you are, let us know!)")])]),t._v(" "),s("p",[t._v("Note that you can include environment variables in your image names and tags. This is helpful\nif you set your image tag based on things like the current Git branch, tag, or commit SHA.")]),t._v(" "),s("h3",{attrs:{id:"manifests"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#manifests"}},[t._v("#")]),t._v(" Manifests")]),t._v(" "),s("p",[t._v("Specify any YAML or Helm manifests you'd like Insights to scan for configuration issues.\nHelm files can be templated using a variables file, or by specifying variables directly\nin your fairwinds-insights.yaml")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("manifests.yaml")]),t._v(" - an array of directories or files containing Kubernetes YAML manifests to scan")]),t._v(" "),s("li",[s("code",[t._v("manifests.helm")]),t._v(" - an array of helm charts to template and scan")]),t._v(" "),s("li",[s("code",[t._v("manifests.helm[].name")]),t._v(" - a name to give this templated chart")]),t._v(" "),s("li",[s("code",[t._v("manifests.helm[].path")]),t._v(" - the path to the directory containing "),s("code",[t._v("Chart.yaml")])]),t._v(" "),s("li",[s("code",[t._v("manifests.helm[].values")]),t._v(" - values to pass to the chart when templating")]),t._v(" "),s("li",[s("code",[t._v("manifests.helm[].valuesFile")]),t._v(" - a YAML file containing values to pass to the chart when templating")])]),t._v(" "),s("h2",{attrs:{id:"connect-to-github"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#connect-to-github"}},[t._v("#")]),t._v(" Connect to GitHub")]),t._v(" "),s("blockquote",[s("p",[t._v("Using Gitlab, Bitbucket, or another Git host? Let us know!")])]),t._v(" "),s("p",[t._v("Connecting Insights to your GitHub repository will help you get the most out of the CI integration.\nTo get started, click the "),s("strong",[t._v("Install Now")]),t._v(" link on your organization's repositories tab.")]),t._v(" "),s("p",[t._v("Then, in the GitHub UI, choose which repositories you'd like to link to Insights:\n"),s("img",{attrs:{src:t.$withBase("/img/github-add-repo.png"),alt:"action items"}})]),t._v(" "),s("p",[t._v("Once your repository is linked, you'll start seeing a Fairwinds Insights status on each of your\npull requests.\n"),s("img",{attrs:{src:t.$withBase("/img/github-status.png"),alt:"action items"}})]),t._v(" "),s("p",[t._v("We recommend setting "),s("code",[t._v("options.setExitCode: false")]),t._v(" in your fairwinds-insights.yaml, since\nthis check will now fail in place of your CI pipeline.")]),t._v(" "),s("h2",{attrs:{id:"viewing-the-results"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#viewing-the-results"}},[t._v("#")]),t._v(" Viewing the Results")]),t._v(" "),s("p",[t._v("The "),s("strong",[t._v("Repositories")]),t._v(" tab will show you a list of all repositories that have been connected to Insights.\nNext to each repo, you can see the number of "),s("code",[t._v("danger")]),t._v(" and "),s("code",[t._v("warning")]),t._v(" items currently found in the main\nbranch.\n"),s("img",{attrs:{src:t.$withBase("/img/repos-list.png"),alt:"action items"}})]),t._v(" "),s("p",[t._v("When you click on a particular repository, the first thing you'll see is a list of action items\naffecting the main branch.\n"),s("img",{attrs:{src:t.$withBase("/img/repo-main-branch.png"),alt:"action items"}})]),t._v(" "),s("p",[t._v("Below that, you'll see a section for each branch, along with a list of action items that have\nbeen created or fixed in that branch.")]),t._v(" "),s("p",[t._v("For example, here's a branch that creates some security issues in "),s("code",[t._v("passing.yaml")]),t._v(":\n"),s("img",{attrs:{src:t.$withBase("/img/repo-failing-branch.png"),alt:"action items"}})]),t._v(" "),s("p",[t._v("And here's a branch that fixes some security issues in "),s("code",[t._v("failing.yaml")]),t._v(":\n"),s("img",{attrs:{src:t.$withBase("/img/repo-passing-branch.png"),alt:"action items"}})])])}),[],!1,null,null,null);e.default=n.exports}}]);